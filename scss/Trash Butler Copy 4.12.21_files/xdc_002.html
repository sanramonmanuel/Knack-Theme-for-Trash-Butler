<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="xdc_data_002/json2.js"></script>
    <script type="text/javascript" src="xdc_data_002/jquery.js"></script>
    <script type="text/javascript" src="xdc_data_002/underscore-min.js"></script></head><body>--&gt;
    <script type="text/javascript" src="xdc_data_002/easyXDM.js"></script>
    <script type="text/javascript">

      $(document).ready(function(){

        /*
        // Helper function to get a URL from a Model or Collection as a property
        // or as a function.
        var getUrl = function(object) {
          if (!(object && object.url)) return null;
          return _.isFunction(object.url) ? object.url() : object.url;
        };

        // Throw an error when a URL is needed, and none is supplied.
        var urlError = function() {
          throw new Error('A "url" property or function must be specified');
        };

        var methodMap = {
          'create': 'POST',
          'update': 'PUT',
          'delete': 'DELETE',
          'read'  : 'GET'
        };
        */

        var socket = new easyXDM.Socket({
          onMessage: function(message, origin) {

            var message = JSON.parse(message);
            var method  = message.method;
            var model   = message.model;
            var options = message.options;
            var params  = message.params;

            options.success = function(data, status, xhr) {
              socket.postMessage(JSON.stringify({data:data, status: status, xhr: xhr, message_id: message.message_id, success: true}));
            }
            options.error   = function(data, status, xhr) {
              socket.postMessage(JSON.stringify({data:data, status: status, xhr: xhr, message_id: message.message_id, success: false}));
            }

            // Make the request, allowing the user to override any Ajax options.
            var data = $.extend({}, params, options);
            return $.ajax(data);
          }
        });
      });
    </script>
  
  

</body></html>